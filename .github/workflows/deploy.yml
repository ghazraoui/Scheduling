name: Deploy to VPS

on:
  push:
    branches:
      - deploy

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger deploy webhook
        run: |
          response=$(curl -sf -X POST \
            -H "X-Deploy-Token: ${{ secrets.DEPLOY_WEBHOOK_SECRET }}" \
            -H "Content-Type: application/json" \
            https://swisslanguagegroup.cloud/webhook/deploy-scheduling)
          echo "$response"
          echo "$response" | jq -e '.status == "success"'
